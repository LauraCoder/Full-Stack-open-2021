(this["webpackJsonpblogilista-frontend"]=this["webpackJsonpblogilista-frontend"]||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),o=n(17),a=n.n(o),s=n(4),i=n.n(s),u=n(5),l=n(2),d=n(6),j=n.n(d),b="/api/blogs",g=null,f={getAll:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j.a.get(b),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,j.a.post(b,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return j.a.put("".concat(b,"/").concat(e),t).then((function(e){return e.data}))},deleteBlog:function(e){var t={headers:{Authorization:g}};return j.a.delete("".concat(b,"/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){g="bearer ".concat(e)}},h={login:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},p=n(0),O=function(e){var t=e.message;return null===t?null:Object(p.jsx)("div",{className:t.type,children:t.text})},x=function(e){var t=e.createBlog,n=Object(r.useState)(""),c=Object(l.a)(n,2),o=c[0],a=c[1],s=Object(r.useState)(""),i=Object(l.a)(s,2),u=i[0],d=i[1],j=Object(r.useState)(""),b=Object(l.a)(j,2),g=b[0],f=b[1];return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:o,author:u,url:g}),d(""),a(""),f("")},children:[Object(p.jsxs)("div",{children:["title",Object(p.jsx)("input",{value:o,id:"title",onChange:function(e){a(e.target.value)}})]}),Object(p.jsxs)("div",{children:["author",Object(p.jsx)("input",{value:u,id:"author",onChange:function(e){d(e.target.value)}})]}),Object(p.jsxs)("div",{children:["url",Object(p.jsx)("input",{value:g,id:"url",onChange:function(e){f(e.target.value)}})]}),Object(p.jsx)("button",{type:"submit",children:"create"})]})})},v=n(8),m=function(e){var t=e.blog,n=e.addMoreLikes;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("li",{children:[Object(p.jsx)("p",{children:t.url}),Object(p.jsxs)("p",{children:["likes: ",t.likes," ",Object(p.jsx)("button",{onClick:n,children:"like"})]})]})})},w=function(e){var t=e.blog,n=e.user,r=e.removeBlog;return n.username!==t.user.username?null:Object(p.jsx)("button",{onClick:r,children:"delete"})},k=function(e){var t=e.blog,n=e.addLikes,c=e.deleteBlog,o=e.user,a=Object(r.useState)(!1),s=Object(l.a)(a,2),i=s[0],u=s[1],d=function(){return u(!i)},j=function(){c(t.id,t.title)},b=i?"hide":"show";return i?Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("li",{className:"blogInfo",children:[Object(p.jsxs)("h4",{children:[t.title," - ",t.author]}),Object(p.jsx)("button",{onClick:d,children:b}),Object(p.jsxs)("ul",{className:"blogInfo",children:[Object(p.jsx)(m,{blog:t,addMoreLikes:function(){var e=Object(v.a)(Object(v.a)({},t),{},{likes:t.likes+1});n(e)},removeBlog:j,user:o}),Object(p.jsx)(w,{removeBlog:j,blog:t,user:o})]})]})}):Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("li",{className:"blogHeader",children:[Object(p.jsxs)("h4",{children:[t.title," - ",t.author]}),Object(p.jsx)("button",{onClick:d,children:b})]})})},y=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(l.a)(n,2),o=c[0],a=c[1],s={display:o?"none":""},i={display:o?"":"none"},u=function(){a(!o)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{style:s,children:Object(p.jsx)("button",{onClick:u,children:e.buttonLabel})}),Object(p.jsxs)("div",{style:i,children:[e.children,Object(p.jsx)("button",{onClick:u,children:"cancel"})]})]})}));y.displayName="Togglable";var S=y,B=function(e){var t=e.handleLogin,n=e.handleUsernameChange,r=e.handlePasswordChange,c=e.username,o=e.password;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:"Log in to application"}),Object(p.jsxs)("form",{onSubmit:t,children:[Object(p.jsxs)("div",{children:["username",Object(p.jsx)("input",{id:"username",value:c,onChange:n})]}),Object(p.jsxs)("div",{children:["password",Object(p.jsx)("input",{id:"password",type:"password",value:o,onChange:r})]}),Object(p.jsx)("button",{type:"submit",id:"login",children:"login"})]})]})},C=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(r.useState)(""),a=Object(l.a)(o,2),s=a[0],d=a[1],j=Object(r.useState)(""),b=Object(l.a)(j,2),g=b[0],v=b[1],m=Object(r.useState)(null),w=Object(l.a)(m,2),y=w[0],C=w[1],T=Object(r.useState)(null),N=Object(l.a)(T,2),L=N[0],I=N[1];Object(r.useEffect)((function(){f.getAll().then((function(e){return c(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);C(t),f.setToken(t.token)}}),[]);var A=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,h.login({username:s,password:g});case 4:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),f.setToken(n.token),C(n),d(""),v(""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),I({text:"wrong credentials",type:"error"}),setTimeout((function(){I(null)}),3e3);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),F=function(e){J.current.toggleVisibility(),f.create(e).then((function(t){c(n.concat(t)),I({text:"a new blog ".concat(e.title," by ").concat(e.author),type:"success"}),setTimeout((function(){I(null)}),3e3),console.log("Blog added")})).catch((function(e){console.log(e.response.data),I({text:"something went wrong, new blog wasn not added",type:"error"}),setTimeout((function(){I(null)}),3e3)}))},J=Object(r.useRef)(),U=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.update(t.id,t);case 2:f.getAll().then((function(e){c(e)})).then((function(){I({text:"New like was added!",type:"success"}),setTimeout((function(){I(null)}),3e3),console.log("Blog added")})).catch((function(e){console.log(e.response.data),I({text:"Adding like did not work",type:"error"}),setTimeout((function(){I(null)}),3e3)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e,t){window.confirm("Delete ".concat(t," ?"))&&f.deleteBlog(e).then((function(r){c(n.filter((function(t){return t.id!==e}))),I({text:"Blog ".concat(t," was deleted"),type:"success"}),setTimeout((function(){I(null)}),2e3),console.log("Blog deleted",r)})).catch((function(r){I({text:"Blog '".concat(t,"' was already removed from server"),type:"error"}),setTimeout((function(){I(null)}),2e3),console.error(r),c(n.filter((function(t){return t.id!==e})))}))};return null===y?Object(p.jsxs)("div",{children:[Object(p.jsx)(O,{message:L}),Object(p.jsx)(B,{handleLogin:A,handleUsernameChange:function(e){var t=e.target;return d(t.value)},handlePasswordChange:function(e){var t=e.target;return v(t.value)},password:g,username:s})]}):Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:"blogs"}),Object(p.jsx)(O,{message:L}),Object(p.jsxs)("p",{children:[y.name," logged in ",Object(p.jsx)("button",{onClick:function(e){e.preventDefault();try{window.localStorage.removeItem("loggedBlogappUser",JSON.stringify(y)),C(null),I({text:"you are now logged out",type:"success"}),setTimeout((function(){I(null)}),3e3)}catch(t){I({text:"something went wrong while logging out",type:"error"}),setTimeout((function(){I(null)}),3e3)}},children:"logout"})]}),Object(p.jsx)(S,{buttonLabel:"new blog",ref:J,children:Object(p.jsx)(x,{createBlog:F})}),Object(p.jsx)("ul",{className:"blogStyle",children:n.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(p.jsx)(k,{blog:e,addLikes:U,deleteBlog:D,user:y},e.id)}))})]})};n(42);a.a.render(Object(p.jsx)(C,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.4addeeba.chunk.js.map